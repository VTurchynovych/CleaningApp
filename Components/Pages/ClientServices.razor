@page "/client-services"
@using CleaningApp.Models
@using CleaningApp.Data.Services
@inject ServiceService _serviceService
@inject NavigationManager _nav
@rendermode InteractiveServer

<div class="container mt-5">
    <div class="text-center mb-5">
        <h6 class="text-primary fw-bold text-uppercase">Nasza Oferta</h6>
        <h2 class="fw-bold display-5">Wybierz usługę dla siebie</h2>
        <p class="text-muted lead">Przejrzyste ceny, zero ukrytych kosztów.</p>
    </div>

    @if (services == null)
    {
        <div class="text-center"><div class="spinner-border text-primary"></div></div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var service in services)
            {
                <div class="col-md-4">
                    <div class="card service-card h-100 border-0 shadow-sm overflow-hidden">
                        <div class="service-img-wrapper">
                            <img src="@(string.IsNullOrEmpty(service.ImageUrl) ? "/img/default-service.jpg" : service.ImageUrl)"
                                 class="card-img-top service-img"
                                 alt="@service.Name"
                                 onerror="this.src='https://via.placeholder.com/400x250?text=Usluga+Sprzatania'" />
                            <div class="price-tag">
                                @(service.DefaultPrice?.ToString("0.00") ?? "0") zł
                            </div>
                        </div>

                        <div class="card-body text-center p-4">
                            <h4 class="card-title fw-bold mb-3">@service.Name</h4>
                            <p class="card-text text-muted">
                                Profesjonalne wykonanie z gwarancją jakości.
                                Idealne rozwiązanie dla Twojego domu.
                            </p>

                            <hr class="my-4" style="opacity: 0.1" />

                            <button class="btn btn-primary w-100 rounded-pill py-2 fw-bold shadow-hover"
                                    @onclick="() => GoToOrder(service.Id)">
                                Zamów tę usługę
                            </button>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

<style>
    .service-card {
        transition: transform 0.3s, box-shadow 0.3s;
    }

        .service-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1) !important;
        }

    .service-img-wrapper {
        position: relative;
        overflow: hidden;
        height: 220px;
    }

    .service-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }

    .service-card:hover .service-img {
        transform: scale(1.1); 
    }

    .price-tag {
        position: absolute;
        bottom: 15px;
        right: 15px;
        background: white;
        color: var(--primary-color);
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .shadow-hover:hover {
        box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
    }
</style>

@code {
    private List<Service> services;

    protected override async Task OnInitializedAsync()
    {
        services = await _serviceService.GetServicesAsync();
    }

    private void GoToOrder(int serviceId)
    {
        _nav.NavigateTo("client-dashboard");
    }
}